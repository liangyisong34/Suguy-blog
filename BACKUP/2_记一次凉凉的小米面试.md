# [记一次凉凉的小米面试](https://github.com/liangyisong34/Suguy-blog/issues/2)

面试官人很好，上来自我介绍完之后就直接开始撸代码。


> 1.手写一个防抖函数，还顺便问了下call,apply,bind的区别
```
function debounce(fn,time){
        let timer
        return function(...args){
            if(timer){
                clearTimeout(timer)
            }
            setTimeout(function(){
                fn.apply(this,args)
            },time)
        }
    }
```


> 2.给一段代码 说出执行顺序，顺便讲了下事件循环
>   这个地方我有点不太会。。。后续补充
```
new Promise((reslove,reject)=>{
        console.log(1)
        resolve()
        console.log(2)
    })

补充：new Promise时候里面是同步执行的，当执行到resolve后会把then的回调函数添加到微任务队列，之后继续执行resolve后面的同步代码，
所以是输出1,2，然后是then的回调函数里面的。

new Promise((resolve,reject)=>{
	console.log(1)
	resolve()
	setTimeout(function(){
		console.log(2)
	},0)		
}).then(resolved=>{
	setTimeout(function(){
		console.log(3)
	},0)
})
输出结果为：1,2,3
盘一下执行顺序：先执行promise里面的同步代码，输出1，然后执行resolve，把里面的回调函数添加到微任务队列，之后继续执行resolve后面
的定时器，回调函数添加到宏任务队列。执行完这些以后，当前主线程栈清空，执行微任务队列，then里面是个定时器，再把这个定时器添加到宏
任务队列（注意，这次添加的是在之前的后面）。微任务队列清空，然后按顺序执行宏任务队列里面的回调函数，依次输出2,3.
```

> 3.给了一个场景，有一些指定的异步任务，现在有一个最大的执行数，同时执行的异步任务不能超过该数，异步任务完成之后立刻有新的去执行，问怎么实现

`这个我想了一会，说用一个队列来存储异步任务，每执行一个异步任务就出队，在异步任务的回调函数里设置调用新的异步任务，写了一段伪代码，说还得考虑一些边界条件，面试官啥也没说就问下一个问题了`

```
补充：去网上看了下，简单说一下思想：
                                    1.设置最大请求数量，当前请求数量，待执行队列。
                                                                  
                                    2.调用时，创建一个新任务，然后判断是否达到最大请求数量，若达到则将任务追加 
                                                                   
                                      到待执行队列，否则，则直接执行该任务。并返回Promise。
                                                               
                                   3.创建任务时，需要返回一个函数，当该任务开始执行则当前数量加一。当任务执行 
                                                                    
                                     完毕时使用finally，当前数量减一，并从待执行队列中取出新任务执行。

目前自己对promise理解的还不是很透彻，后续搞明白了再补充吧....
```

> 后面就是针对我做的项目一些常规的问题，问我怎么性能优化，回流重绘的相关知识，怎么防止内存泄露。。。当知道我们还在兼容es7这种浏览器时表示很震惊，之后问了些响应式布局之类的我都说我们没怎么用到过，都是在js代码里进行特异性兼容。


> 最后介绍了下他们的业务大概是做什么，我听得云里雾里，好像是用伪js做安卓端的框架，还有不同环境的兼容差异，代码运行的环境也是自己做的，还建议我多去了解了解现在主流的框架。。。哎，感觉凉凉，现在心里只有后悔，为什么毕业后选择了这个大坑